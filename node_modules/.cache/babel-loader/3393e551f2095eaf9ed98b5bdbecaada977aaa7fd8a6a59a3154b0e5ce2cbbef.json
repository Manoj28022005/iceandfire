{"ast":null,"code":"import React,{useState}from'react';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function UpdateEmail(_ref){let{darkMode,showEmailModal,setShowEmailModal}=_ref;const[newEmail,setNewEmail]=useState(\"\");const[otp,setOtp]=useState(\"\");const[isOtpSent,setIsOtpSent]=useState(false);const[errorMessage,setErrorMessage]=useState(\"\");const[loading,setLoading]=useState(false);// Loading state\nconst handleSendOtp=async e=>{e.preventDefault();setLoading(true);// Start loading\ntry{const email=localStorage.getItem(\"email\");const response=await fetch(\"http://localhost:5000/api/sendOtp\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({email:newEmail})// Send new email for OTP\n});const json=await response.json();if(json.success){setIsOtpSent(true);alert(\"OTP sent to your new email.\");}else{setErrorMessage(json.message||\"Failed to send OTP.\");}}catch(error){console.error(\"Error:\",error);setErrorMessage(\"An error occurred while sending OTP.\");}finally{setLoading(false);// End loading\n}};const handleVerifyOtp=async e=>{e.preventDefault();setLoading(true);// Start loading\ntry{const email=localStorage.getItem(\"email\");// Get old email\nconst response=await fetch(\"http://localhost:5000/api/verifyOtp\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({oldemail:email,newemail:newEmail,otp})// Correctly pass old and new emails\n});const json=await response.json();if(json.success){alert(\"Email updated successfully.\");setShowEmailModal(false);}else{setErrorMessage(\"Invalid OTP.\");}}catch(error){console.error(\"Error:\",error);setErrorMessage(\"An error occurred during verification.\");}finally{setLoading(false);// End loading\n}};return/*#__PURE__*/_jsx(_Fragment,{children:showEmailModal&&/*#__PURE__*/_jsx(\"div\",{className:\"modal fade show\",style:{display:'block'},role:\"dialog\",children:/*#__PURE__*/_jsx(\"div\",{className:\"modal-dialog\",role:\"document\",children:/*#__PURE__*/_jsxs(\"div\",{className:`modal-content ${darkMode?'bg-dark text-light':'bg-light text-dark'}`,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"modal-title\",children:\"Update Email\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-close\",onClick:()=>setShowEmailModal(false)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-body\",children:!isOtpSent?/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSendOtp,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Enter new email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",className:\"form-control\",value:newEmail,onChange:e=>setNewEmail(e.target.value),required:true})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary\",disabled:loading,children:loading?'Sending...':'Send OTP'}),errorMessage&&/*#__PURE__*/_jsx(\"div\",{className:\"text-danger\",children:errorMessage})]}):/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleVerifyOtp,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Enter OTP\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",value:otp,onChange:e=>setOtp(e.target.value),required:true})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary\",disabled:loading,children:loading?'Verifying...':'Verify OTP'}),errorMessage&&/*#__PURE__*/_jsx(\"div\",{className:\"text-danger\",children:errorMessage})]})})]})})})});}export default UpdateEmail;","map":{"version":3,"names":["React","useState","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","UpdateEmail","_ref","darkMode","showEmailModal","setShowEmailModal","newEmail","setNewEmail","otp","setOtp","isOtpSent","setIsOtpSent","errorMessage","setErrorMessage","loading","setLoading","handleSendOtp","e","preventDefault","email","localStorage","getItem","response","fetch","method","headers","body","JSON","stringify","json","success","alert","message","error","console","handleVerifyOtp","oldemail","newemail","children","className","style","display","role","type","onClick","onSubmit","value","onChange","target","required","disabled"],"sources":["D:/CODING/WEB_DEVELOPMENT/GOFOOD/mernapp/src/screens/UpdateEmail.jsx"],"sourcesContent":["import React, { useState } from 'react';\r\n\r\nfunction UpdateEmail({ darkMode, showEmailModal, setShowEmailModal }) {\r\n  const [newEmail, setNewEmail] = useState(\"\");\r\n  const [otp, setOtp] = useState(\"\");\r\n  const [isOtpSent, setIsOtpSent] = useState(false);\r\n  const [errorMessage, setErrorMessage] = useState(\"\");\r\n  const [loading, setLoading] = useState(false); // Loading state\r\n\r\n  const handleSendOtp = async (e) => {\r\n    e.preventDefault();\r\n    setLoading(true); // Start loading\r\n    try {\r\n      const email = localStorage.getItem(\"email\");\r\n      const response = await fetch(\"http://localhost:5000/api/sendOtp\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({ email: newEmail }), // Send new email for OTP\r\n      });\r\n\r\n      const json = await response.json();\r\n      if (json.success) {\r\n        setIsOtpSent(true);\r\n        alert(\"OTP sent to your new email.\");\r\n      } else {\r\n        setErrorMessage(json.message || \"Failed to send OTP.\");\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error:\", error);\r\n      setErrorMessage(\"An error occurred while sending OTP.\");\r\n    } finally {\r\n      setLoading(false); // End loading\r\n    }\r\n  };\r\n\r\n  const handleVerifyOtp = async (e) => {\r\n    e.preventDefault();\r\n    setLoading(true); // Start loading\r\n    try {\r\n      const email = localStorage.getItem(\"email\"); // Get old email\r\n      const response = await fetch(\"http://localhost:5000/api/verifyOtp\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({ oldemail: email, newemail: newEmail, otp }), // Correctly pass old and new emails\r\n      });\r\n\r\n      const json = await response.json();\r\n      if (json.success) {\r\n        alert(\"Email updated successfully.\");\r\n        setShowEmailModal(false);\r\n      } else {\r\n        setErrorMessage(\"Invalid OTP.\");\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error:\", error);\r\n      setErrorMessage(\"An error occurred during verification.\");\r\n    } finally {\r\n      setLoading(false); // End loading\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {showEmailModal && (\r\n        <div className=\"modal fade show\" style={{ display: 'block' }} role=\"dialog\">\r\n          <div className=\"modal-dialog\" role=\"document\">\r\n            <div className={`modal-content ${darkMode ? 'bg-dark text-light' : 'bg-light text-dark'}`}>\r\n              <div className=\"modal-header\">\r\n                <h5 className=\"modal-title\">Update Email</h5>\r\n                <button type=\"button\" className=\"btn-close\" onClick={() => setShowEmailModal(false)}></button>\r\n              </div>\r\n              <div className=\"modal-body\">\r\n                {!isOtpSent ? (\r\n                  <form onSubmit={handleSendOtp}>\r\n                    <div className=\"mb-3\">\r\n                      <label className=\"form-label\">Enter new email</label>\r\n                      <input\r\n                        type=\"email\"\r\n                        className=\"form-control\"\r\n                        value={newEmail}\r\n                        onChange={(e) => setNewEmail(e.target.value)}\r\n                        required\r\n                      />\r\n                    </div>\r\n                    <button type=\"submit\" className=\"btn btn-primary\" disabled={loading}>\r\n                      {loading ? 'Sending...' : 'Send OTP'}\r\n                    </button>\r\n                    {errorMessage && <div className=\"text-danger\">{errorMessage}</div>}\r\n                  </form>\r\n                ) : (\r\n                  <form onSubmit={handleVerifyOtp}>\r\n                    <div className=\"mb-3\">\r\n                      <label className=\"form-label\">Enter OTP</label>\r\n                      <input\r\n                        type=\"text\"\r\n                        className=\"form-control\"\r\n                        value={otp}\r\n                        onChange={(e) => setOtp(e.target.value)}\r\n                        required\r\n                      />\r\n                    </div>\r\n                    <button type=\"submit\" className=\"btn btn-primary\" disabled={loading}>\r\n                      {loading ? 'Verifying...' : 'Verify OTP'}\r\n                    </button>\r\n                    {errorMessage && <div className=\"text-danger\">{errorMessage}</div>}\r\n                  </form>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default UpdateEmail;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}